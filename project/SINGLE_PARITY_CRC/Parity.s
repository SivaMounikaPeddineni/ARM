 AREA     appcode, CODE, READONLY
     EXPORT __main
	 IMPORT printMsg
     ENTRY 
__main  FUNCTION
; EVEN PARITY CODE IMPLEMENTATION	
	LDR R4,= 0xF0000017 ; VALUE TO BE TRANSMITTED LOADED HERE
	LDR R5,= 0x00000020 ; COUNT = 31 VALUE LOADED HERE
	LDR R8,= 0x80000000
	LDR R9,= 0x00000000 ; NUMBER OF 1'S STORED IN R9
	LDR R10,= 0x00000000 ; USED FOR COUNTER
	LDR R11,= 0x00000001 ; USED FOR COUNTER
	MOV R6,R4
	LSL R6,#1 ; LEFT SHIFT BY 1 BIT
	BL NOOFONES ; THIS LOOP CALCULATES NUMBER OF 1'S
	BL EVENODDLOOP ; THIS LOOP DETECT WHETHER EVEN/ODD NUMBER OF 1'S ARE PRESENT
	CMP R9,R11
	ADDEQ R6,#1 ; IF NUMBER OF 1'S IS ODD THEN ADD 1 TO MAKE IT EVEN
	BL RECEIVER
		
NOOFONES
    MOV R7,R4
	AND R7,#0x80000000
	CMP R7,R8
	ADDEQ R9,#1
	ROR R4,R4,#1
	SUB R5,#1
	CMP R5,R10
	BNE NOOFONES
	;BL EVENODDLOOP
	BX LR
	
EVENODDLOOP
	AND R9,#0x00000001
	BX LR
	
RECEIVER
	LDR R12,= 0xF0000016 ; RECEIVED BIT IS STORED HERE
	MOV R4,R12 
	LDR R9,= 0x00000000
	LDR R5,= 0x00000020
	BL NOOFONES
	BL EVENODDLOOP
	CMP R9,R11 ; R9 = 1 => ERROR
	MOVEQ R0,#1 ; IF R0 = 1 => ERROR DETECTED ELSE NO ERROR
	BL printMsg
	
stop    B stop ; stop program
        ENDFUNC
        END 		
			